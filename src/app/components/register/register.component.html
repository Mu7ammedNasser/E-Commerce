<section class="bg-main-light shadow p-2 my-4 rounded-3">
  <h1 class="h2 text-main text-capitalize">register now:</h1>

  <form [formGroup]="registerForm" (ngSubmit)="registerSubmit()">
    <div class="my-2">
      <label for="name">name</label>
      <input
        id="name"
        type="text"
        class="form-control"
        formControlName="name"
        [ngClass]="{
          'is-valid': !registerForm.get('name')?.errors && (registerForm.get('name')?.touched || registerForm.get('name')?.dirty ) ,
          'is-invalid': registerForm.get('name')?.errors && (registerForm.get('name')?.touched || registerForm.get('name')?.dirty ),
        }"
      />
      @if (registerForm.get('name')?.errors &&
      (registerForm.get('name')?.touched || registerForm.get('name')?.dirty )) {
      <div class="alert alert-danger my-2 w-50">
        @if(registerForm.get('name')?.getError('required')) {
        <p class="m-0">Name is required</p>
        }@else if (registerForm.get('name')?.getError('minlength')) {
        <p class="m-0">Name should be more than or equal 3 chars</p>
        }@else if (registerForm.get('name')?.getError('maxlength')) {
        <p class="m-0">Name should be less than or equal 20 chars</p>
        }
      </div>
      }
    </div>
    <div class="my-2">
      <label for="email">email</label>
      <input
        [ngClass]="{
        'is-valid': !registerForm.get('email')?.errors && (registerForm.get('email')?.touched || registerForm.get('email')?.dirty ) ,
        'is-invalid': registerForm.get('email')?.errors && (registerForm.get('email')?.touched || registerForm.get('email')?.dirty ),
      }"
        id="email"
        type="email"
        class="form-control"
        formControlName="email"
      />
      @if (registerForm.get('email')?.errors &&
      (registerForm.get('email')?.touched || registerForm.get('email')?.dirty ))
      {
      <div class="alert alert-danger my-2 w-50">
        @if(registerForm.get('email')?.getError('required')) {
        <p class="m-0">Email is required</p>
        }@else if (registerForm.get('email')?.getError('email')) {
        <p class="m-0">Enter Valid email</p>
        }
      </div>
      }
    </div>
    <div class="my-2">
      <label for="phone">phone</label>
      <input
        id="name"
        type="tel"
        class="form-control"
        formControlName="phone"
        [ngClass]="{
          'is-valid': !registerForm.get('phone')?.errors && (registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty ) ,
          'is-invalid': registerForm.get('phone')?.errors && (registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty ),
        }"
      />
      @if (registerForm.get('phone')?.errors &&(
      registerForm.get('phone')?.dirty || registerForm.get('phone')?.touched)) {
      <div class="alert alert-danger my-2 w-50">
        @if( registerForm.get('phone')?.getError('required')) {
        <p class="m-0">Phone is required</p>
        }@else if (registerForm.get('phone')?.getError('pattern')) {
        <p class="m-0">Enter Valid phone number</p>
        }
      </div>
      }
    </div>
    <div class="my-2">
      <label for="password">password</label>
      <input
        id="password"
        type="password"
        class="form-control"
        formControlName="password"
        [ngClass]="{
          'is-valid': !registerForm.get('password')?.errors && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty ) ,
          'is-invalid': registerForm.get('password')?.errors && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty ),
        }"
      />
      @if(registerForm.get('password')?.errors &&
      (registerForm.get('password')?.touched ||
      registerForm.get('password')?.dirty )) {
      <div class="alert alert-danger my-2 w-50">
        @if(registerForm.get('password')?.getError('required')) {
        <p class="m-0">Password is required</p>
        }@else if (registerForm.get('password')?.getError('pattern')) {
        <p class="m-0">number of chars should be more than 6 chars</p>
        }
      </div>
      }
    </div>
    <div class="my-2">
      <label for="repassword">repassword</label>
      <input
        id="repassword"
        type="password"
        class="form-control"
        formControlName="rePassword"
        [ngClass]="{
          'is-valid': !registerForm.getError('mismatch') &&
      (registerForm.get('rePassword')?.touched ||
      registerForm.get('rePassword')?.dirty )  ,
          'is-invalid': registerForm.getError('mismatch') &&
      (registerForm.get('rePassword')?.touched ||
      registerForm.get('rePassword')?.dirty ) ,
        }"
      />
      @if(registerForm.getError('mismatch') &&
      (registerForm.get('rePassword')?.touched ||
      registerForm.get('rePassword')?.dirty )){
      <p class="alert alert-danger my-2 w-50 m-0">
        Password confirmation is incorrect
      </p>
      }
    </div>
    <button type="submit" class="btn-main d-block ms-auto">
      register @if(isLoading) {
      <i class="fas fa-spin fa-spinner"></i>
      }
    </button>

    @if(msgError) {
    <p class="alert alert-danger w-50 m-auto text-center fw-bold">
      {{ msgError }}
    </p>

    } @if(messageSuccess) {
    <p class="alert alert-success w-50 m-auto text-center fw-bold">SUCCESS</p>
    }
  </form>
</section>
